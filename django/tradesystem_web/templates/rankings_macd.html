{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>MACDåˆ†æçµæœãƒ©ãƒ³ã‚­ãƒ³ã‚°</title>
    <link rel="stylesheet" href="{% static 'base.css' %}?v=20260214-4">
    <link rel="stylesheet" href="{% static 'rankings_macd.css' %}?v=20260218-1">
</head>
<body>
    <h1>MACDåˆ†æçµæœãƒ©ãƒ³ã‚­ãƒ³ã‚°</h1>
    <div class="meta">å¯¾è±¡æŒ‡æ¨™: MACD({{ window_short }},{{ window_long }},{{ window_signal }}) / ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ  = MACD - Signal / å¯¾è±¡æ—¥: {% if trade_date %}{{ trade_date|date:"Y-m-d" }}{% else %}-{% endif %}</div>

    <div class="filter-bar">
        <form method="get">
            <label for="market">å¸‚å ´ãƒ»å•†å“åŒºåˆ†</label>
            <select id="market" name="market">
                <option value="">å…¨ã¦</option>
                {% for market in markets %}
                <option value="{{ market }}" {% if market == selected_market %}selected{% endif %}>{{ market }}</option>
                {% endfor %}
            </select>
            <button type="submit">çµã‚Šè¾¼ã¿</button>
            {% if selected_market %}
            <a class="button subtle" href="{% url 'rankings_macd' %}">ã‚¯ãƒªã‚¢</a>
            {% endif %}
        </form>
    </div>

    <div class="ranking-grid">
        <section class="ranking-panel">
            <h2>MACD ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ä¸Šä½ TOP10</h2>
            <table>
                <thead>
                    <tr>
                        <th>é †ä½</th>
                        <th>ã‚³ãƒ¼ãƒ‰</th>
                        <th>éŠ˜æŸ„å</th>
                        <th>å¸‚å ´ãƒ»å•†å“åŒºåˆ†</th>
                        <th>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ </th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in macd_top10 %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ item.code }}</td>
                        <td>{{ item.name }}</td>
                        <td>{{ item.market }}</td>
                        <td>{{ item.histogram|floatformat:4 }}</td>
                        <td>
                            <a class="action-link" href="{% url 'stock_macd_chart' item.code %}">ğŸ“ˆ MACD</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>

        <section class="ranking-panel">
            <h2>MACD ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ä¸‹ä½ TOP10</h2>
            <table>
                <thead>
                    <tr>
                        <th>é †ä½</th>
                        <th>ã‚³ãƒ¼ãƒ‰</th>
                        <th>éŠ˜æŸ„å</th>
                        <th>å¸‚å ´ãƒ»å•†å“åŒºåˆ†</th>
                        <th>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ </th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in macd_bottom10 %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ item.code }}</td>
                        <td>{{ item.name }}</td>
                        <td>{{ item.market }}</td>
                        <td>{{ item.histogram|floatformat:4 }}</td>
                        <td>
                            <a class="action-link" href="{% url 'stock_macd_chart' item.code %}">ğŸ“ˆ MACD</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
    </div>

    <div class="pagination">
        <a class="button" href="{% url 'tse_listings_list' %}">ä¸€è¦§ã¸æˆ»ã‚‹</a>
    </div>
</body>
</html>

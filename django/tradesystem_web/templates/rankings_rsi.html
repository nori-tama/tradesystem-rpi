{% extends 'base_layout.html' %}
{% load static %}

{% block title %}RSIåˆ†æçµæœãƒ©ãƒ³ã‚­ãƒ³ã‚°{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'rankings_rsi.css' %}?v=20260215-1">
{% endblock %}

{% block content %}
    <h1>RSIåˆ†æçµæœãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆ{{ ranking_direction_label }} TOP10ï¼‰</h1>
    <div class="meta">å¯¾è±¡æŒ‡æ¨™: RSI({{ window }})</div>

    <div class="pagination">
        <a class="button" href="{% url 'rankings_rsi_top' %}{% if selected_market %}?market={{ selected_market }}{% endif %}">ä¸Šä½ TOP10</a>
        <a class="button" href="{% url 'rankings_rsi_bottom' %}{% if selected_market %}?market={{ selected_market }}{% endif %}">ä¸‹ä½ TOP10</a>
    </div>

    <div class="filter-bar">
        <form method="get">
            <label for="market">å¸‚å ´ãƒ»å•†å“åŒºåˆ†</label>
            <select id="market" name="market">
                <option value="">å…¨ã¦</option>
                {% for market in markets %}
                <option value="{{ market }}" {% if market == selected_market %}selected{% endif %}>{{ market }}</option>
                {% endfor %}
            </select>
            <button type="submit">çµã‚Šè¾¼ã¿</button>
            {% if selected_market %}
                {% if ranking_direction == 'top' %}
                <a class="button subtle" href="{% url 'rankings_rsi_top' %}">ã‚¯ãƒªã‚¢</a>
                {% else %}
                <a class="button subtle" href="{% url 'rankings_rsi_bottom' %}">ã‚¯ãƒªã‚¢</a>
                {% endif %}
            {% endif %}
        </form>
    </div>

    <section class="ranking-panel">
        <table>
            <thead>
                <tr>
                    <th>é †ä½</th>
                    <th>ã‚³ãƒ¼ãƒ‰</th>
                    <th>éŠ˜æŸ„å</th>
                    <th>å¸‚å ´ãƒ»å•†å“åŒºåˆ†</th>
                    <th>RSI</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for item in ranking_rows %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ item.code }}</td>
                    <td>{{ item.name }}</td>
                    <td>{{ item.market }}</td>
                    <td>{{ item.score|floatformat:2 }}</td>
                    <td>
                        <a class="action-link" href="{% url 'stock_rsi_chart' item.code %}?window={{ window }}">ğŸ“ˆ RSI</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>

{% endblock %}
